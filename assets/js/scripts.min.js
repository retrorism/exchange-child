function handleScroll(){var e=pageYOffset;jQuery(window).scroll(function(){var a=jQuery(this).scrollTop();e=a,pageYOffset<100?jQuery(".breadcrumbs-bar").removeClass("scrolled"):jQuery(".breadcrumbs-bar").addClass("scrolled")})}function getArchiveMap(){if(void 0!==Exchange&&void 0!==Exchange.PluginExtensions&&void 0!==Exchange.PluginExtensions.LMP&&void 0!==Exchange.PluginExtensions.LMP.maps){for(var e in Exchange.PluginExtensions.LMP.maps)if(Exchange.PluginExtensions.LMP.maps.hasOwnProperty(e)){var a=Exchange.PluginExtensions.LMP.maps[e];a.hash=e.slice(4);break}return a?a:void 0}}function getUrlVars(){for(var e,a=[],t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<t.length;r++)e=t[r].split("="),a.push(e[0]),a[e[0]]=e[1];return a}function getFocusTranslate(e,a){if(img_data=e.parentNode.dataset,!img_data)return!1;var t=a.clientHeight,r=e.offsetHeight,o=img_data.focus_h*t-r/2,n=(t-r)/t*100,s=o/t*100;return!(o<0||s<0)&&(s>n?n:s)}function doFocusTranslate(e){var a=e.parentNode;if(translate=getFocusTranslate(a,e),translate){var t=translate>0?-1*translate:translate,r="transform: translateY("+t+"%);";e.setAttribute("style",r)}}jQuery(document).foundation();var masonryOptions={percentPosition:!0,columnWidth:".masonry__grid-sizer",gutter:".masonry__gutter-sizer",itemSelector:".archive__grid__griditem"},masonryIsActive=!1;!function(e){e(document).ready(function(){if(void 0==a)var a=e(".archive__grid__masonry");if(1===e(".featuredgrid__masonry").length){var a=e(".featuredgrid__masonry");masonryOptions.itemSelector=".featuredgrid__griditem"}e(".focus").each(function(){var a=e(this).find(".image--main");a.on("load",function(e){doFocusTranslate(e.target)})});for(var t=document.querySelectorAll(".floated"),r=0;r<t.length;r++){var o=t[r].nextElementSibling,n=t[r].offsetHeight,s=o.offsetHeight;n>s&&(o.style.height=n+"px")}if(e("a[data-open=story__modal--gallery]").on("click",function(a){a.preventDefault();var t=e(this).data("img_id"),r=e("#story__modal--gallery").find("#"+t);e(".orbit").foundation("changeSlide",!0,r)}),e("#token-form__submit").on("click",function(a){a.preventDefault(),e(this).prop("disabled",!0);var t=e(".token-form__collab-select option:selected"),r=e(".grid--form-options"),o=getUrlVars().pr;if(void 0!==t){var n={action:"exchange_token_form",update_id:t.val(),prid:t.data("programme-round"),token:o,security:e(".token-form__nonce").val()};e(".loader-pointer").remove(),e(".loader-wrapper").addClass("go"),r.html(""),e.ajax({url:exchange_ajax.ajax_url,method:"POST",data:n}).done(function(a){r.html(a),e(".loader-wrapper").removeClass("go"),e(this).removeProp("disabled")})}}),e(".translatedparagraph--has_translations").each(function(){var a=e(this).find(".translation-select");a.on("change",function(){function a(a){return function(t,r){e(this).removeClass("show"),e(this).hasClass(a)&&e(this).addClass("show")}}var t="paragraph--"+this.value,r=e(this).parent().parent(".translatedparagraph--has_translations");paragraphs=r.children(".translatedparagraph__paragraph"),paragraphs.each(a(t))})}),(e("body").hasClass("single")||e("body").hasClass("page-child"))&&e("#main").on("scrollme.zf.trigger",handleScroll),e("body").hasClass("archive")||e("body").hasClass("page-template-archive")||1===e(".featuredgrid__masonry").length){if(e("body").hasClass("post-type-archive-participant")){if(void 0===i)var i=getArchiveMap();i&&i.map.fitBounds(i.clusterLayer.getBounds())}void 0!==a&&(a.masonry(masonryOptions),masonryIsActive=!0)}e(".archive__facets__type__reset").on("click",function(){void 0!=FWP&&FWP.reset()}),e("#facet-switch").on("click",function(){"#main".foundation("toggle")}),e(".accordion p:empty, .orbit p:empty").remove(),e(".archive__grid .columns","relatedgrid .columns").last().addClass("end"),e('iframe[src*="youtube.com"], iframe[src*="vimeo.com"]').each(function(){e(this).innerWidth()/e(this).innerHeight()>1.5?e(this).wrap("<div class='widescreen flex-video'/>"):e(this).wrap("<div class='flex-video'/>")})}),e(document).on("click",".fwp-load-more",function(){e(".fwp-load-more").html("Loading..."),FWP.is_load_more=!0,FWP.paged=parseInt(FWP.settings.pager.page)+1,FWP.soft_refresh=!0,FWP.refresh()}),e(document).on("facetwp-loaded",function(){var a=e(".archive__grid__masonry");masonryIsActive&&a.masonry("destroy"),a.masonry(masonryOptions),masonryIsActive=!0;var t=getArchiveMap();if(void 0!==t){var r=window["leaflet_objects_"+t.hash];if(void 0!==r&&0!=r.map_markers.length&&0!=FWP.settings.matches.length){if(r.map_markers.length>0&&FWP.settings.matches.length>0){var o=r.map_markers.filter(function(e){if(FWP.settings.matches.includes(e.id))return!0});if(o.length>0){var n={map_markers:o};t.renderObjects(n)}}FWP.settings.pager.page<FWP.settings.pager.total_pages?!FWP.loaded&&1>e(".fwp-load-more").length?e(".facetwp-template").after('<button style="clear: both;" class="fwp-load-more">Load more</button>'):e(".fwp-load-more").html("Load more").show():e(".fwp-load-more").hide(),FWP.settings.pager.page>1&&e("html, body").animate({scrollTop:e(".archive__grid__masonry").offset().bottom},1e3)}}}),e(document).on("facetwp-refresh",function(){if(FWP.loaded||(FWP.paged=1),e("body").hasClass("page-template-archive")){if(void 0!==FWP&&"archive_filtered"===FWP.template){var a="Results for: ";for(var t in FWP.facets)if(FWP.facets.hasOwnProperty(t))for(var r=0;r<FWP.facets[t].length;r++)a+=FWP.facets[t][r].replace(/-/g," ");e(".archive__title-wrapper").html("<h1>"+a+"</h1>")}console.log(a)}})}(jQuery);
//# sourceMappingURL=scripts.min.js.map
